<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G.N.R - 3D Attendance System</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --bg: #050505;
            --panel: #1a1a2e;
            --3d-text: linear-gradient(180deg, #fff 0%, #aaa 100%);
            --gold: #f1c40f;
            --green: #2ecc71;
            --orange: #e67e22;
            --red: #e74c3c;
        }

        body {
            font-family: 'Arial Black', sans-serif;
            background: var(--bg);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .designer-tag {
            align-self: flex-start;
            font-size: 1.8rem;
            background: linear-gradient(to right, #00dbde, #fc00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(2px 2px 5px rgba(0,219,222,0.5));
            margin-bottom: 15px;
        }

        /* The Report Container to be Captured as Image */
        #reportCapture {
            background: var(--panel);
            padding: 25px;
            border-radius: 15px;
            border: 4px solid #303050;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
            width: 100%;
            max-width: 700px;
        }

        h2 {
            text-align: center;
            font-size: 1.5rem;
            color: var(--gold);
            text-shadow: 3px 3px 0px #000, 5px 5px 0px rgba(0,0,0,0.2);
            text-transform: uppercase;
            margin-top: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #11112b;
        }

        th {
            background: #252545;
            color: #00d2ff;
            padding: 15px 5px;
            border: 1px solid #333;
            font-size: 0.8rem;
        }

        td {
            border: 1px solid #333;
            padding: 10px 5px;
            text-align: center;
            font-size: 0.85rem;
        }

        /* 3D Animated Font Fill for Sections */
        .sec-3d {
            font-weight: 900;
            color: #ff0080;
            text-shadow: 1px 1px 0px #fff, 2px 2px 0px #000;
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 2px #ff0080); }
            to { filter: drop-shadow(0 0 8px #ff0080); }
        }

        input {
            background: #000;
            border: 1px solid #444;
            color: #fff;
            text-align: center;
            padding: 5px;
            border-radius: 4px;
        }

        .abs-input { width: 45px; font-weight: bold; font-size: 1.1rem; }
        .men-input { width: 140px; font-size: 0.7rem; color: #888; border: none; background: transparent; }

        .perc-bold { font-weight: bold; font-size: 1rem; }

        .total-row { background: #252545; font-weight: bold; color: var(--gold); }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            width: 100%;
            max-width: 700px;
            margin-top: 20px;
        }

        button {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }

        .download-btn { background: #6c5ce7; color: white; }
        .wa-btn { background: #25D366; color: white; }
    </style>
</head>
<body>

    <div class="designer-tag">G.N.R</div>

    <div id="reportCapture">
        <h2>NA BLOCK ATTENDANCE REPORT</h2>
        <table>
            <thead>
                <tr>
                    <th>SECTION</th>
                    <th>STR</th>
                    <th>ABS</th>
                    <th>%</th>
                    <th>MENTOR NAMES</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
            <tfoot>
                <tr class="total-row">
                    <td>TOTAL</td>
                    <td id="tStr">0</td>
                    <td id="tAbs">0</td>
                    <td id="tPerc">0%</td>
                    <td>-</td>
                </tr>
            </tfoot>
        </table>
        <p style="font-size: 0.7rem; color: #aaa; margin-top: 15px; text-align: center;">
            * All class incharges/mentors are requested to do PCR for your respective section.
        </p>
    </div>

    <div class="btn-group">
        <button class="download-btn" onclick="downloadImage()">Download Table Image</button>
        <button class="wa-btn" onclick="sendWhatsApp()">Send WhatsApp Text</button>
    </div>

    <script>
        const data = [
            { s: "CSE-C", st: 60, m: "Mr.Yogesh/Ms.Anusuya" },
            { s: "CSE-D", st: 62, m: "Dr.Adrish/Mr.Govind rao" },
            { s: "CSE-E", st: 58, m: "Ms.Sukanya/Mr.Pradeep" },
            { s: "CSM-A", st: 63, m: "Ms.Shivani/Ms.K.Shivani" },
            { s: "IT-A", st: 49, m: "Ms.Alpana Singh/Mr.Sujith" },
            { s: "ECE-A", st: 69, m: "Ms.Sumayyah/Mr.Sainath" },
            { s: "ECE-B", st: 69, m: "Mr.Muzammil/Ms.Anusha" },
            { s: "DS", st: 62, m: "Dr.Subhasish/Ms.Jayanthi" }
        ];

        function init() {
            const tbody = document.getElementById('tableBody');
            data.forEach((item, i) => {
                tbody.innerHTML += `
                    <tr>
                        <td class="sec-3d">${item.s}</td>
                        <td>${item.st}</td>
                        <td><input type="number" class="abs-input" oninput="update()"></td>
                        <td class="perc-bold" id="p-${i}">100%</td>
                        <td><input type="text" class="men-input" value="${item.m}"></td>
                    </tr>
                `;
            });
            update();
        }

        function update() {
            const absInputs = document.querySelectorAll('.abs-input');
            let totalS = 0, totalA = 0;

            data.forEach((item, i) => {
                let a = parseInt(absInputs[i].value) || 0;
                let p = ((item.st - a) / item.st) * 100;
                let cell = document.getElementById(`p-${i}`);
                
                cell.innerText = p.toFixed(1) + '%';
                
                // Color Logic
                if(p > 75) cell.style.color = "var(--green)";
                else if(p >= 60) cell.style.color = "var(--orange)";
                else cell.style.color = "var(--red)";

                totalS += item.st;
                totalA += a;
            });

            document.getElementById('tStr').innerText = totalS;
            document.getElementById('tAbs').innerText = totalA;
            let totalP = ((totalS - totalA) / totalS) * 100;
            document.getElementById('tPerc').innerText = totalP.toFixed(2) + '%';
        }

        function downloadImage() {
            const report = document.getElementById('reportCapture');
            html2canvas(report, { backgroundColor: '#050505' }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'NA_Block_Report.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        function sendWhatsApp() {
            let msg = `*NA BLOCK ATTENDANCE REPORT*\n\n`;
            const absInputs = document.querySelectorAll('.abs-input');
            data.forEach((item, i) => {
                let a = absInputs[i].value || 0;
                let p = document.getElementById(`p-${i}`).innerText;
                msg += `üìç *${item.s}* | Abs: ${a} | *${p}*\n`;
            });
            msg += `\nüìä *TOTAL:* Str: ${document.getElementById('tStr').innerText} | Abs: ${document.getElementById('tAbs').innerText} | *${document.getElementById('tPerc').innerText}*\n\n`;
            msg += `_All class incharges/mentors are requested to do PCR for your respective section._\n\n`;
            msg += `*Designed by G.N.R*`;
            window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`, '_blank');
        }

        init();
    </script>
</body>
</html>
